define sleeplong
shell sleep 15
end

define sleepshort
shell sleep 10
end

shell echo '\e[1;4;31m Next command: start - run by start of main()\e[m'
sleepshort
start

shell echo '\e[1;4;31m Next command: break *0x4005a7; continue \e[m'
shell echo '\e[1;4;31m  0x4005a7: call   0x400549 <function1> \e[m'
sleeplong
break *0x4005a7
continue

shell echo '\e[1;4;31m Next command: stepi \e[m'
shell echo '\e[1;4;31m  call function1() - jump function1 and push return address to stack\e[m'
sleepshort
stepi
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  set rbp\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  set rbp\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  extend rsp for local variables\e[m'
sleepshort
nexti

shell echo '\e[1;4;31m Next command: break *0x400587; continue \e[m'
shell echo '\e[1;4;31m  0x400587: call   0x400502 <function2> \e[m'
sleeplong
break *0x400587
continue

shell echo '\e[1;4;31m Next command: stepi \e[m'
shell echo '\e[1;4;31m  call function2() - jump function2 and push return address to stack\e[m'
sleepshort
stepi
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  set rbp\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  set rbp\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  extend rsp for local variables\e[m'
sleepshort
nexti

shell echo '\e[1;4;31m Next command: break *0x400547; continue \e[m'
shell echo '\e[1;4;31m  0x400587: leave \e[m'
sleeplong
break *0x400547
continue
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  leave: restore rsp, pop rbp \e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  ret: jmp rsp, pop\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  nop: no operation \e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  leave: restore rsp, pop rbp \e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  ret: jmp rsp, pop\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  mov rax, 0x0: set return value of main()\e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: nexti \e[m'
shell echo '\e[1;4;31m  pop rsp: restore rbp \e[m'
sleepshort
nexti
shell echo '\e[1;4;31m Next command: continue \e[m'
shell echo '\e[1;4;31m  ret: jmp rsp, pop\e[m'
sleeplong
continue
